# Практический разбор по теме 2

## Живая работа в оболочке

### Навигация по файловой системе

#### Текущий каталог

```
# Текущий каталог
pwd
```

#### Просмотр содержимого каталога
```
# Просмотр содержимого каталога
ls

# Расширенный вывод
ls -l

# Скрытые файлы
ls -a

# Расширенный вывод + скрытые файлы
ls -la 
ls -al
```

#### Переход между каталогами

```
# Переход в каталог
cd catalog_name

# Переход на уровень выше
cd ..

# Переход в домашний каталог
cd ~

# Возврат в предыдущий каталог
cd -
```

### Создание каталогов и файлов

#### Создание каталога

```
# Создание каталога
mkdir catalog_name

# Создание вложенных каталогов
mkdir -p catalog_name/catalog_name

# Удаление пустого каталога
rmdir catalog_name

# Удаление каталога с содержимым
rm -r catalog_name
```

#### Создание файлов

```
# Создание пустого файла
touch file_name

# Создание файла с текстом
echo "Work with shell" > file_name

# Удаление файла
rm file_name
```

### Поиск файла

#### Поиск по имени

```
# Поиск по имени
find . -name "file_name"

# Поиск всех файлов с расширением
find . -name "*.txt"
```

#### Поиск по содержимому

```
# Поиск слова в файле
grep "word" file_name

# Поиск во всех txt-файлах
grep "word" *.txt
```

### Перенаправление вывода

#### Перезапись файла

```
# Перезапись файла
ls > list.txt
```

#### Добавление в файл

```
# Добавление в файл
ls >> list.txt
```

#### Перенаправление ошибок

```
# Перенаправление ошибок
cat nofile.txt 2> errors.txt
```

### Конвейер из 2–3 команд

#### Простой конвейер

```
# Простой конвейер
ls -l | grep ".txt"
```

Что происходит:
1. `ls -l` выводит список файлов 
2. вывод передаётся в `grep`
3. `grep` фильтрует строки

#### Конвейер из трёх команд

```
# Конвейер из трёх команд
ls | grep ".txt" | wc -l
```

Что происходит:
1. `ls` → список файлов
2. `grep` → отбор
3. `wc -l` → подсчёт строк

## Написание скриптов

### Аргументы и базовая логика

Скрипт принимает имя пользователя и приветствует его.
Если аргумент не передан – выводит ошибку.

```bash
#!/bin/bash

if [[ $# -eq 0 ]]; then
    echo "Ошибка: не передано имя"
    exit 1
fi

name="$1"

echo "Привет, $name!"
```

### Работа с файлами и циклами

Скрипт:
- принимает имя каталога
- проверяет, существует ли он
- выводит список .txt файлов
- считает их количество

```bash
#!/bin/bash

if [[ $# -eq 0 ]]; then
    echo "Укажите каталог"
    exit 1
fi

dir="$1"

if [[ ! -d "$dir" ]]; then
    echo "Каталог не существует"
    exit 1
fi

count=0

for file in "$dir"/*.txt; do
    if [[ -f "$file" ]]; then
        echo "Найден файл: $file"
        ((count++))
    fi
done

echo "Всего txt-файлов: $count"
```

### Работа с процессами и логированием

Скрипт:
- принимает команду
- запускает её
- записывает вывод в лог
- сообщает об успешности выполнения

```bash
#!/bin/bash

if [[ $# -eq 0 ]]; then
    echo "Передайте команду"
    exit 1
fi

logfile="run.log"

run_command() {
    echo "Запуск: $@" >> "$logfile"
    "$@" >> "$logfile" 2>&1
    return $?
}

run_command "$@"

status=$?

if [[ $status -eq 0 ]]; then
    echo "Команда выполнена успешно"
else
    echo "Ошибка выполнения (код $status)"
fi
```
